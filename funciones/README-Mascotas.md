# Mascotas CRUD API

This Azure Function provides CRUD operations for the `vt2_mascotas` table.

## Table Structure

```sql
CREATE TABLE vt2_mascotas (
  mascota_id  BIGINT GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  cliente_id  BIGINT NOT NULL,
  nombre      VARCHAR(100) NOT NULL,
  especie     VARCHAR(50) NOT NULL,
  edad        INT,
  domestico   BOOLEAN NOT NULL DEFAULT TRUE,

  CONSTRAINT fk_vt2_mascota_cliente
    FOREIGN KEY (cliente_id)
    REFERENCES vt_clientes (cliente_id)
);
```

## API Endpoints

### Mascotas Operations (Default)

#### GET /api/Mascotas
- **Description**: Get all mascotas or a specific mascota by ID
- **Query Parameters**:
  - `id` (optional): Get mascota by ID
  - `cliente_id` (optional): Get all mascotas for a specific cliente
- **Examples**:
  - `GET /api/Mascotas` - Get all mascotas
  - `GET /api/Mascotas?id=1` - Get mascota with ID 1
  - `GET /api/Mascotas?cliente_id=1` - Get all mascotas for cliente 1

#### POST /api/Mascotas
- **Description**: Create a new mascota
- **Body**: JSON object with mascota data
- **Example**:
```json
{
  "cliente_id": 1,
  "nombre": "Luna",
  "especie": "Perro",
  "edad": 3,
  "domestico": true
}
```

#### PUT /api/Mascotas?id={id}
- **Description**: Update an existing mascota
- **Query Parameters**:
  - `id`: ID of the mascota to update
- **Body**: JSON object with updated mascota data
- **Example**:
```json
{
  "cliente_id": 1,
  "nombre": "Luna Updated",
  "especie": "Perro",
  "edad": 4,
  "domestico": true
}
```

#### DELETE /api/Mascotas?id={id}
- **Description**: Delete a mascota
- **Query Parameters**:
  - `id`: ID of the mascota to delete



## Data Model

### MascotaDTO
```json
{
  "mascota_id": 1,
  "cliente_id": 1,
  "nombre": "Luna",
  "especie": "Perro",
  "edad": 3,
  "domestico": true
}
```

### Field Descriptions
- `mascota_id`: Primary key (auto-generated)
- `cliente_id`: Foreign key to vt_clientes table (required)
- `nombre`: Pet name (required, max 100 characters)
- `especie`: Species (required, max 50 characters)
- `edad`: Age in years (optional)
- `domestico`: Whether the pet is domestic (defaults to true)

## Testing

Use the provided `test-mascotas.ps1` script to test the API:

```powershell
.\test-mascotas.ps1
```

Make sure the Azure Function is running locally on port 7071 before running the tests.

## Error Handling

The API returns appropriate HTTP status codes:
- `200 OK`: Successful GET/PUT operations
- `201 Created`: Successful POST operations
- `204 No Content`: Successful DELETE operations
- `400 Bad Request`: Invalid input data
- `404 Not Found`: Resource not found
- `500 Internal Server Error`: Server errors

## Database Connection

The function connects to a PostgreSQL database with the following configuration:
- Host: 40.67.145.51:5432
- Database: duoc
- User: duoc
- Password: 84oL4mK6cM8w7SK
